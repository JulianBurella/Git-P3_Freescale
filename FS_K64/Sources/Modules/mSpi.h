/*
------------------------------------------------------------
Copyright 2003-201x Haute école ARC Ingéniérie, Switzerland. 
All rights reserved.
------------------------------------------------------------
Nom du fichier : 	mSpi.h	
Auteur et Date :	Monnerat Serge 29 août 2013

But : 

-----------------------------------------------------------------------------
Historique:
-----------------------------------------------------------------------------

$History: $


-----------------------------------------------------------------------------
*/

#ifndef __mSpi__
#define __mSpi__

#include "..\Utils\def.h"


// Type des devices sur le SPI0
typedef enum
{
	kHBridgeA,
	kHBridgeB,
	kCamera
}Spi0DeviceEnum;

//-----------------------------------------------------------------------
// SPI setup
//-----------------------------------------------------------------------
void mSpi_Setup(void);

//-----------------------------------------------------------------------
// SPI open
//-----------------------------------------------------------------------
void mSpi_Open(void);

//-----------------------------------------------------------------------
// SPI close
//-----------------------------------------------------------------------
void mSpi_Close(void);

//-----------------------------------------------------------------------
// SPI send and read one frame
//-----------------------------------------------------------------------
UInt16 mSpi_SP1ReadWrite(UInt16 aData);

//-----------------------------------------------------------------------
// SPI send and read one frame
//-----------------------------------------------------------------------
UInt16 mSpi_SP0ReadWrite(Spi0DeviceEnum aDevice,UInt16 aData);

//-----------------------------------------------------------------------
// Envoi et réception caméra dig MLX75306
//-----------------------------------------------------------------------
UInt32 mSpi_MLX75306_RXTX(UInt32 aData);

//-----------------------------------------------------------------------
// Reset de la caméra dig MLX75306
//-----------------------------------------------------------------------
void mSpi_MLX75306_Reset(void);

//-----------------------------------------------------------------------
// Acquisition de la lumière --> caméra dig MLX75306
// Le temps d'intégration: aIntVal (entre 0 et 65535) / 10MHz
// 32765 --> 6.5 ms SI normal
// 65535 --> 104.8 ms Long SI
//-----------------------------------------------------------------------
void mSpi_MLX75306_StartIntegration(float aMs);

//-----------------------------------------------------------------------
// Acquisition de la lumière --> caméra dig MLX75306
// Le temps d'intégration: aIntVal (entre 0 et 65535) / 10MHz
// 65535 --> 6.5 ms
//-----------------------------------------------------------------------
void mSpi_MLX75306_StartIntegration_old(float aAdVal);

//-----------------------------------------------------------------------
// Lecture d'une image de la caméra dig MLX75306
//-----------------------------------------------------------------------
void mSpi_MLX75306_ReadPicture(UInt8 *aTab);

//-----------------------------------------------------------------------
// Lecture d'une image de la caméra dig MLX75306
// Tableau de 16 bits pour l'app Labview
//-----------------------------------------------------------------------
void mSpi_MLX75306_ReadPictureTest(UInt16 *aTab);

#endif
